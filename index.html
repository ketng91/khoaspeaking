<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Essay Writing - Lớp Anh thầy Kết</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>

<style>
/* ===== BODY ===== */
body {
  font-family: Arial, sans-serif;
  background-color: #fff8f0;
  margin: 0;
  padding: 0;
  text-align: center;
}

/* ===== HEADER ===== */
header {
  background-color: #ffd6ba;
  padding: 15px 20px;
  font-weight: bold;
  color: #7a4e3e;
  display: flex;
  flex-wrap: wrap;       
  align-items: center;
  justify-content: space-between;  /* Left luôn bên trái, center căn giữa */
  gap: 15px;
}

/* Left: icon + home text */
.header-left {
  display: flex;
  align-items: center;
  gap: 8px;
  flex: 0 0 auto;          /* không bị co lại */
}

.header-left a {
  display: flex;
  align-items: center;
  gap: 8px;
  font-size: 24px;
  color: #7a4e3e;
  text-decoration: none;
}

.header-left a i {
  font-size: 28px;
}

/* Center title */
.header-center {
  flex: 1;                 /* chiếm phần còn lại để căn giữa */
  text-align: center;
  font-size: 32px;
}

/* ===== TOP SELECT ===== */
.top-select {
  display: flex;
  justify-content: flex-start;
  margin: 20px 40px;
}

select {
  padding: 8px 14px;
  font-size: 18px;
  border-radius: 8px;
  border: 2px solid #a0e7e5;
  background-color: #e3fdfd;
}

/* ===== WORD LIST ===== */
.word-list {
  width: 85%;
  margin: 20px auto;
  background-color: #E0FBE2;
  border-radius: 10px;
  padding: 15px;
  text-align: left;
  font-size: 22px;
}

.word-row {
  display: flex;
  justify-content: flex-start;
  align-items: center;
  padding: 6px 10px;
  border-bottom: 1px dashed #ffb3ba;
  transition: all .2s ease-in-out;
}
.word-row:last-child { border-bottom: none; }

.word-row:hover {
  background-color: #fffacd;
  transform: scale(1.02);
  cursor: pointer;
}

.tick-box {
  margin-right: 10px;
  width: 18px;
  height: 18px;
  cursor: pointer;
}

/* ===== REVIEW BOX ===== */
.review-box {
  margin: 40px auto;
  width: 70%;
  background-color: #ffe5ec;
  padding: 25px;
  font-weight: bold;
  color: #607274;
  font-size: 26px;
  border-radius: 12px;
  position: relative;
  display: flex;
  flex-direction: column;
  align-items: center;
}

.review-box.speaking { background-color: #e0f7ff; }

.display-container {
  width: 100%;
  min-height: 100px;
  text-align: center;
}

#answer, #engAnswer {
  font-size: 22px;
  color: #7a4e3e;
  margin-top: 10px;
  min-height: 30px;
}

.review-buttons {
  display: flex;
  justify-content: center;
  margin-top: 20px;
  gap: 15px;
}

.review-buttons button {
  background-color: #a0e7e5;
  border: none;
  padding: 12px 20px;
  font-size: 20px;
  border-radius: 8px;
  cursor: pointer;
}

.review-buttons button:hover {
  background-color: #ffb3ba;
}

/* ===== FOOTER ===== */
footer {
  font-size: 22px;
  margin-top: 40px;
  padding: 20px;
  color: #7a4e3e;
  background-color: #fff0e1;
}

/* ===== WRITING SECTION ===== */
.writing-section {
  width: 100%;
  display: flex;
  flex-direction: column;
  align-items: flex-start;
  gap: 15px;
}

#essayPrompt {
  background-color: #f0f7ff;
  border-radius: 10px;
  padding: 5px;
  font-size: 22px;
  color: #004d61;
  text-align: left;
  width: 100%;
}

#essayText {
  width: 100%;
  height: 500px;
  font-size: 20px;
  padding: 10px;
  border-radius: 10px;
  border: 2px solid #a0e7e5;
  resize: vertical;
  min-height: 400px;
  max-height: 800px;
  font-family: Arial, sans-serif; 
}

#submitEssayBtn {
  align-self: flex-end;
  margin-top: 10px;
  padding: 12px 20px;
  font-size: 20px;
  border-radius: 8px;
  border: none;
  background-color: #a0e7e5;
  cursor: pointer;
}
#submitEssayBtn:hover {
  background-color: #ffb3ba;
}

/* ===== FIREWORK ===== */
.firework {
  position: absolute;
  width: 6px;
  height: 6px;
  border-radius: 50%;
  pointer-events: none;
  animation: explode 0.7s ease-out forwards;
}

@keyframes explode {
  0% { transform: scale(1); opacity: 1; }
  100% { transform: scale(5); opacity: 0; }
}

/* ===== MEDIA QUERY ===== */
@media (max-width: 480px) {
  header {
    padding: 10px 15px;
  }
  .header-left a {
    font-size: 18px;
  }
  .header-left a i {
    font-size: 20px;
  }
  .header-center {
    font-size: 22px;
  }
}
</style>
</head>

<body>

<header>
  <div class="header-left">
    <a href="https://ketng91.github.io/lopanhthayket/">
      <i class="fa-solid fa-house"></i> Lớp Anh thầy Kết
    </a>
  </div>
  <div class="header-center">
    Essay Writing
  </div>
</header>

<div class="top-select">
  <select id="wordList">
    <option value="1">Environment</option>
    <option value="2">Education</option>
  </select>
</div>

<div class="word-list" id="wordContainer"></div>

<div class="review-box" id="reviewBox">
  <div class="display-container">
    <div id="vietWord">Chọn Bộ từ vựng để bắt đầu</div>
    <div id="answer" style="display:none;"></div>
  </div>
  <div class="review-buttons">
    <button onclick="know()">Đã biết</button>
    <button onclick="dontKnow()">Chưa biết</button>
    <button onclick="nextWord()">Tiếp theo</button>
  </div>
</div>

<div class="review-box speaking">
  <div style="font-size:28px; color:#004d61; margin-bottom:10px;">
    Thực hành Writing Essay
  </div>

  <div class="writing-section">
    <div id="essayPrompt">Chọn topic để hiển thị đề essay.</div>
    <textarea id="essayText" placeholder="Viết bài essay ở đây..."></textarea>
    <button id="submitEssayBtn" onclick="submitEssay()">Submit</button>
  </div>
</div>

<footer>Chúc mừng bạn đã hoàn thành bài học!</footer>

<script>
function know(){ alert("Đã biết"); }
function dontKnow(){ alert("Chưa biết"); }
function nextWord(){ alert("Tiếp theo"); }
function submitEssay(){ alert("Bài essay đã được gửi!"); }
</script>

</body>
</html>

<script>
/********** DATA từ vựng **********/
const data = {
  1: [
   { en:"fossil fuels /ˈfɒs.əl fjʊəlz/", vn:"nhiên liệu hóa thạch", tick:false },
{ en:"renewable energy /rɪˈnjuː.ə.bəl ˈen.ə.dʒi/", vn:"năng lượng tái tạo", tick:false },
{ en:"solar power /ˈsoʊ.lɚ ˈpaʊ.ɚ/", vn:"năng lượng mặt trời", tick:false },
{ en:"wind energy /wɪnd ˈen.ə.dʒi/", vn:"năng lượng gió", tick:false },
{ en:"hydroelectric power /ˌhaɪ.droʊ.ɪˈlek.trɪk ˈpaʊ.ɚ/", vn:"thủy điện", tick:false },
{ en:"greenhouse gas emissions /ˈɡriːn.haʊs ɡæs ɪˈmɪʃ.ənz/", vn:"khí thải nhà kính", tick:false },
{ en:"carbon footprint /ˈkɑːr.bən ˈfʊt.prɪnt/", vn:"dấu chân carbon", tick:false },
{ en:"energy security /ˈen.ə.dʒi sɪˈkjʊr.ə.ti/", vn:"an ninh năng lượng", tick:false },
{ en:"climate change /ˈklaɪ.mət tʃeɪndʒ/", vn:"biến đổi khí hậu", tick:false },
{ en:"sustainable development /səˈsteɪ.nə.bəl dɪˈvel.əp.mənt/", vn:"phát triển bền vững", tick:false },
{ en:"fossil fuel dependency /ˈfɒs.əl fjʊəl dɪˈpen.dən.si/", vn:"sự phụ thuộc vào nhiên liệu hóa thạch", tick:false },
{ en:"renewable infrastructure /rɪˈnjuː.ə.bəl ˈɪn.frəˌstrʌk.tʃɚ/", vn:"cơ sở hạ tầng năng lượng tái tạo", tick:false },
{ en:"energy transition /ˈen.ə.dʒi trænsˈɪʃ.ən/", vn:"chuyển đổi năng lượng", tick:false },
{ en:"air pollution /er pəˈluː.ʃən/", vn:"ô nhiễm không khí", tick:false },
{ en:"fossil fuel reserves /ˈfɒs.əl fjʊəl rɪˈzɜːrvz/", vn:"dự trữ nhiên liệu hóa thạch", tick:false },
{ en:"eco-friendly /ˌiː.koʊˈfrend.li/", vn:"thân thiện môi trường", tick:false },
{ en:"energy efficiency /ˈen.ə.dʒi ɪˈfɪʃ.ən.si/", vn:"hiệu quả năng lượng", tick:false },
{ en:"global warming /ˌɡloʊ.bəl ˈwɔːr.mɪŋ/", vn:"nóng lên toàn cầu", tick:false },
{ en:"technological innovation /ˌtek.nəˈlɒdʒ.ɪ.kəl ˌɪn.əˈveɪ.ʃən/", vn:"đổi mới công nghệ", tick:false },
{ en:"fossil fuel extraction /ˈfɒs.əl fjʊəl ɪkˈstræk.ʃən/", vn:"khai thác nhiên liệu hóa thạch", tick:false }

  ],
  2: [
    { en:"higher education /ˈhaɪ.ər ˌedʒ.əˈkeɪ.ʃən/", vn:"giáo dục đại học", tick:false },
{ en:"tuition fees /tjuːˈɪʃ.ən fiːz/", vn:"học phí", tick:false },
{ en:"financial burden /faɪˈnæn.ʃəl ˈbɜːr.dən/", vn:"gánh nặng tài chính", tick:false },
{ en:"student loan /ˈstjuː.dənt loʊn/", vn:"khoản vay sinh viên", tick:false },
{ en:"academic achievement /ˌæk.əˈdem.ɪk əˈtʃiːv.mənt/", vn:"thành tích học tập", tick:false },
{ en:"equal opportunity /ˌiː.kwəl ˌɑː.pɚˈtuː.nə.t̬i/", vn:"cơ hội bình đẳng", tick:false },
{ en:"intellectual growth /ˌɪn.t̬əlˈek.tʃu.əl ɡroʊθ/", vn:"sự phát triển trí tuệ", tick:false },
{ en:"social mobility /ˌsoʊ.ʃəl moʊˈbɪl.ə.ti/", vn:"tính di động xã hội", tick:false },
{ en:"merit-based /ˈmer.ɪt beɪst/", vn:"dựa trên thành tích", tick:false },
{ en:"public funding /ˈpʌb.lɪk ˈfʌn.dɪŋ/", vn:"ngân sách công", tick:false },
{ en:"access to education /ˈæk.ses tuː ˌedʒ.əˈkeɪ.ʃən/", vn:"tiếp cận giáo dục", tick:false },
{ en:"knowledge acquisition /ˈnɒl.ɪdʒ ˌæk.wɪˈzɪʃ.ən/", vn:"tiếp thu kiến thức", tick:false },
{ en:"brain drain /ˈbreɪn dreɪn/", vn:"chảy máu chất xám", tick:false },
{ en:"career prospects /kəˈrɪər ˈprɒs.pekts/", vn:"cơ hội nghề nghiệp", tick:false },
{ en:"economic disparity /ˌiː.kəˈnɒm.ɪk dɪˈspær.ɪ.ti/", vn:"sự chênh lệch kinh tế", tick:false },
{ en:"inclusive education /ɪnˈkluː.sɪv ˌedʒ.əˈkeɪ.ʃən/", vn:"giáo dục hòa nhập", tick:false },
{ en:"lifelong learning /ˌlaɪf.lɒŋ ˈlɜː.nɪŋ/", vn:"học tập suốt đời", tick:false },
{ en:"scholarship /ˈskɒl.ɚ.ʃɪp/", vn:"học bổng", tick:false },
{ en:"student debt /ˈstjuː.dənt det/", vn:"nợ sinh viên", tick:false },
{ en:"educational inequality /ˌedʒ.əˈkeɪ.ʃən.əl ˌɪn.ɪˈkwɒl.ɪ.ti/", vn:"bất bình đẳng giáo dục", tick:false },

  ]
};

/********** DATA Essay Writing theo topic **********/
const writingPrompts = {
  1: [
    { prompt: "While fossil fuels are still the main source of energy for most countries, others have started to rely on renewable options such as wind and solar power. Is this an advantageous or disadvantageous trend?" }
  ],
  2: [
    { prompt: "Some people believe that university education should be free for everyone. To what extent do you agree or disagree?" },
  ]
};

/********** QUẢN LÝ TỪ VỰNG **********/
let currentWords = [];
let originalOrder = [];
let currentIndex = 0;
const wordContainer = document.getElementById('wordContainer');
const vietWord = document.getElementById('vietWord');
const answer = document.getElementById('answer');
const reviewBox = document.getElementById('reviewBox');

function loadWords(topicId) {
  currentWords = data[topicId].map((item, index) => ({...item, originalIndex: index}));
  currentIndex = 0;
  originalOrder = [...currentWords];

  renderWordList();
  if(currentWords.length > 0){
    vietWord.innerText = currentWords[0].vn;
    answer.style.display = 'none';
  }
}

function renderWordList() {
  wordContainer.innerHTML = '';
  currentWords.forEach((item) => {
    const row = document.createElement('div');
    row.className = 'word-row';
    
    const tick = document.createElement('input');
    tick.type = 'checkbox';
    tick.className = 'tick-box';
    tick.checked = item.tick;
    tick.addEventListener('click', (e) => {
      e.stopPropagation();
      item.tick = tick.checked;
      reorderWord(item);
      renderWordList();
    });

    row.appendChild(tick);

    const textSpan = document.createElement('span');
    textSpan.style.flexGrow = "1";
    textSpan.innerHTML = `${item.en} - ${item.vn}`;
    row.appendChild(textSpan);

    row.addEventListener('mouseenter', ()=>{ row.style.backgroundColor="#fffacd"; });
    row.addEventListener('mouseleave', ()=>{ row.style.backgroundColor=""; });

    wordContainer.appendChild(row);
  });
}

function reorderWord(word) {
  if(word.tick){
    currentWords = currentWords.filter(w => w !== word);
    currentWords.unshift(word);
  } else {
    currentWords.sort((a,b) => a.originalIndex - b.originalIndex);
  }
}

function nextWord(){
  if(currentWords.length === 0) return;
  currentIndex = (currentIndex + 1) % currentWords.length;
  vietWord.innerText = currentWords[currentIndex].vn;
  answer.style.display = 'none';
}

function know(){
  if(currentWords.length === 0) return;
  currentWords[currentIndex].tick = true;
  reorderWord(currentWords[currentIndex]);
  renderWordList();
  nextWord();
  triggerFirework();
}

function dontKnow(){
  if(currentWords.length === 0) return;
  answer.innerText = currentWords[currentIndex].en;
  answer.style.display = 'block';
}

/********** Firework effect **********/
/********** Firework effect - Bung toả rực rỡ **********/
function triggerFirework(){
  const numParticles = 50; // số tia bung ra
  const centerX = reviewBox.offsetWidth / 2;
  const centerY = reviewBox.offsetHeight / 2;

  for(let i=0;i<numParticles;i++){
    const fire = document.createElement('div');
    fire.className = 'firework';
    fire.style.background = `hsl(${Math.random()*360}, 100%, 60%)`;
    fire.style.left = `${centerX}px`;
    fire.style.top = `${centerY}px`;
    
    const angle = Math.random() * 2 * Math.PI;
    const distance = 80 + Math.random() * 80; // độ dài tia
    const dx = Math.cos(angle) * distance;
    const dy = Math.sin(angle) * distance;

    fire.animate([
      { transform: 'translate(0,0) scale(1)', opacity: 1 },
      { transform: `translate(${dx}px, ${dy}px) scale(2)`, opacity: 0 }
    ], { duration: 800, easing: 'ease-out' });

    reviewBox.appendChild(fire);
    setTimeout(()=>{ fire.remove(); }, 800);
  }
}

/********** Switch topic và load prompt essay ngẫu nhiên **********/
const essayPromptDiv = document.getElementById('essayPrompt');
const essayText = document.getElementById('essayText');
const wordListSelect = document.getElementById('wordList');

wordListSelect.addEventListener('change', function() {
  const topicId = this.value;
  loadWords(topicId);

  const prompts = writingPrompts[topicId];
  const randomIndex = Math.floor(Math.random() * prompts.length);
  essayPromptDiv.innerText = prompts[randomIndex].prompt;
  essayText.value = '';
});

/********** LOAD MẶC ĐỊNH KHI MỞ PAGE **********/
window.addEventListener('DOMContentLoaded', () => {
  const defaultTopic = wordListSelect.value;
  loadWords(defaultTopic);

  const prompts = writingPrompts[defaultTopic];
  const randomIndex = Math.floor(Math.random() * prompts.length);
  essayPromptDiv.innerText = prompts[randomIndex].prompt;
  essayText.value = '';
});

/********** Submit Essay lưu file txt **********/
function submitEssay() {
  const text = essayText.value.trim();
  if(!text) { alert("Vui lòng viết bài essay trước khi Submit."); return; }
  const blob = new Blob([text], {type: "text/plain;charset=utf-8"});
  const now = new Date();
  const filename = `essay_${now.getFullYear()}-${now.getMonth()+1}-${now.getDate()}_${now.getHours()}-${now.getMinutes()}-${now.getSeconds()}.txt`;
  saveAs(blob, filename);
  alert("Bài essay đã được lưu thành công!");
}
</script>

</body>
</html>
